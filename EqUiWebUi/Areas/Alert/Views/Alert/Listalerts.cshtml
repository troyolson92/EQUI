@model IEnumerable<EqUiWebUi.Areas.Alert.Models.h_alert>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Index of all alerts for this user</h2>

@Html.Grid(Model).Named("h_alert").Build(columns =>
{
    columns.Add(c => c.id).Titled("ID").InitialSort(GridSortOrder.Desc).Css("hidden-sm hidden-xs");
    columns.Add(c => c.c_triggers.alertType).Titled("alertType");
    columns.Add(c => c.C_timestamp).Titled("C_timestamp").Formatted("{0:dd-MM-yyyy HH:mm}").Css("hidden-sm hidden-xs");
    columns.Add(c => c.location).Titled("location");
    columns.Add(c => c.alarmobject).Titled("alarmobject").Css("hidden-sm hidden-xs");
    columns.Add(c => c.Classification).Titled("Class").Css("hidden-sm hidden-xs");
    columns.Add(c => c.info).Titled("info");
    columns.Add(c => c.ChangedUser.username.Replace(@"VCCNET\", "")).Titled("ChangedUser").Css("hidden-sm hidden-xs");
    columns.Add(c => c.triggerCount).Titled("TC").Css("hidden-sm hidden-xs");
    columns.Add(c => c.c_state.state).Titled("state");

    //add edit button
    columns.Add(c => c)
                .Titled("")
                .Encoded(false)
                .RenderedAs(c => MyFilters.IconActionLink(Url.Action("Edit", new { id = c.id }), "glyphicon glyphicon-pencil", "", "Edit this alert")
                ).Filterable(false);

}).Filterable(true).Sortable(true).Pageable(pager =>
{
    pager.RowsPerPage = 7;
}).Empty("Did not find anything").Css("table-hover").RowCss(row => MyRowStyling.getRowStyleStatus(row.c_state.state))

<p></p>
@*info model in page for alert details *@
<div class="container">
    <div class="panel panel-default">
        <div class="panel-body">
            <div id="alertDetailsPartial">Click on a row for more details about the alert</div>
        </div>
    </div>
</div>
@section scripts{
    <script>
        //full with screen
        $("#allcontent").removeClass("body-content");
        $("#allcontent").removeClass("container");

        //subscribe to row clicked events
        $('.mvc-grid').mvcgrid({
            rowClicked: function (row, data, e) {
                console.log(data);
                $(row).addClass('active').siblings().removeClass('active');
                $("#alertDetailsPartial").html("Loading.....");
                var url = "@Url.Action("_Details")?id=" + data.id;
                $("#alertDetailsPartial").load(url);
            }
        });
    </script>
}


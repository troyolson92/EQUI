@model IEnumerable<EqUiWebUi.Models.Supervisie>

@*set title*@
@{
    ViewBag.Title = "Supervisie";
}

<div>
    <p></p>
    <p></p>
    <div>
        <div>
            @Html.Grid(Model).Named("DataGrid").Build(columns =>
                         {
                             columns.Add(c => c.Location).Titled("Location").Filterable(true);
                             columns.Add(c => c.logtext).Titled("Logtext");
                             columns.Add(c => c.DT).Titled("DT");
                             columns.Add(c => c.time).Titled("time");
                             columns.Add(c => c.Classification).Titled("Class");
                             columns.Add(c => c.Subgroup).Titled("Subgroup");
                             columns.Add(c => c.Logtype).Titled("LogType").Filterable(true);
                             columns.Add(c => c.LocationTree)
                             .Titled("Info")
                             .Encoded(false)
                             .Filterable(true)
                             .RenderedAs(o => Html.ActionLink("INFO", "_Moreinfo",
                                new
                                {
                                    location = o.Location,
                                    errornum = o.Logcode,
                                    refid = o.refId,
                                    logtype = o.Logtype,
                                    logtext = o.logtext
                                },
                                  new { @class = "modal-link" }
                                  )
                             );
                         }).Sortable().Pageable(pager =>
                             {
                                 pager.RowsPerPage = 20;
                             }).Empty("No data found")
        </div>

        <div class="panel-footer">
            @MyFilters.LocationDropdownBrownfield("/Gadata/SupervisieWebgrid", "")
            <p style="float:right"> Last data push: '@Html.Raw(ViewBag.DataTimestamp)'</p>
        </div>
    </div>
</div>


@*render popuover modal*@
<div>
    @MyModals.tableHelperModal("tableModal");
</div>


<script type="text/javascript">
    //need to just eleminiate this... can use the attributes of the modal
    var bModalOpen = false;
    //

    $(document).ready(function () {
        //set colors for grid
        tableFormatLogtype(7);
        //enable blinking
        tableFormatBlink(7, 6);
        //subscribe to modal click
        ListenToModal('#tableModal');
        //enable polling for new data
        PolFordata(5, '@Html.Raw(ViewBag.DataTimestamp)', '@Url.Action("SupervisiecheckNewData")');
        //hide the navbar and move body content up
        $(".navbar-fixed-top").autoHidingNavbar().hide();
        $("#allcontent").animate({ "margin-top": "-60px" }, "fast");
    });
</script>
